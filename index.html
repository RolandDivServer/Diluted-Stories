<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diluted Stories</title>
  <meta name="description" content="Unfiltered perspectives on power, poverty & society." />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css" />

  <!-- Prefer light/dark color in browser UI -->
  <meta name="color-scheme" content="light dark">
</head>
<body>
<!--
  HEADER
  - Brand is perfectly centered via a 3-column grid.
  - Right side: navigation + controls (Theme, Text size, Read Aloud).
-->
<header class="ds-header" role="banner">
  <div class="wrap header-grid">
    <!-- Left spacer for centering grid -->
    <div aria-hidden="true"></div>

    <!-- Centered brand -->
    <a class="brand" href="./index.html">DILUTED STORIES</a>

    <!-- Right: nav + controls -->
    <div class="header-right">
      <nav class="ds-nav" aria-label="Primary">
        <a href="./articles.html">Articles</a>
        <a href="./contact.html">Contact</a>
      </nav>

      <div class="a11y-controls" aria-label="Accessibility and theme controls">
        <button id="themeToggle" class="ui-btn" aria-pressed="false" title="Toggle dark or light mode">ðŸŒ“</button>
        <button id="textBigger" class="ui-btn" title="Increase text size" aria-label="Increase text size">A+</button>
        <button id="textSmaller" class="ui-btn" title="Decrease text size" aria-label="Decrease text size">Aâˆ’</button>
        <button id="ttsToggle" class="ui-btn" aria-pressed="false" title="Read this page aloud">ðŸ”ˆ</button>
      </div>
    </div>
  </div>
</header>

<main id="main-content">
  <!-- HERO -->
<section class="wrap hero-spot">
  <article class="hero-card">
    <!-- Open the in-page preview instead of redirecting -->
    <a class="card-link" href="#right-to-repair" aria-label="Read: What is the Right to Repair movement?"></a>

    <!-- Use a reliable Unsplash Source URL -->
    <img
      loading="lazy"
      alt="Phone repair on a lit workbench"
      src="https://images.unsplash.com/photo-1576613109753-27804de2cba8?"
    >

    <div class="hero-overlay">
      <span class="badge">FEATURE</span>
      <h1 class="hero-title">What is the Right to Repair movement?</h1>
      <p class="hero-sub">How targeted legislation can curb e-waste and extend device lifespans.</p>
      <div class="byline">By R. Correia Â· 8 min read</div>
    </div>
  </article>
</section>
<!-- === ARTICLE PREVIEW MODAL (HERO ONLY FOR NOW) === -->
<div id="articleModal" class="ds-modal" role="dialog" aria-modal="true" aria-labelledby="articleTitle" hidden>
  <div class="ds-modal__scrim" data-close-modal></div>

  <div class="ds-modal__panel" role="document">
    <div class="ds-modal__bar">
      <button class="ui-btn" id="btnRead" aria-pressed="false" title="Read this article aloud">ðŸ”ˆ Read</button>
      <div class="spacer"></div>
      <button class="ui-btn" id="btnAplus" title="Increase text size" aria-label="Increase text size">A+</button>
      <button class="ui-btn" id="btnAminus" title="Decrease text size" aria-label="Decrease text size">Aâˆ’</button>
      <button class="ui-btn ds-modal__close" data-close-modal aria-label="Close preview">âœ•</button>
    </div>

    <article class="ds-article" id="articleContent">
      <h1 id="articleTitle" class="article-title"></h1>
      <p class="article-meta muted"></p>
      <img class="article-hero" alt="">
      <div class="article-body"></div>
    </article>
  </div>
</div>
  <!-- === ARTICLE DATA FOR HERO PREVIEW === -->
<template id="tpl-right-to-repair">
{
  "title": "What is the Right to Repair movement?",
  "meta": "By R. Correia Â· 8 min read",
  "imgAlt": "Phone repair on a lit workbench",
  "imgSrc": "https://source.unsplash.com/PZLgTUAhxMM/1600x900",
  "body": [
    "<p>The Right to Repair movement argues that consumers and independent repairers should have practical access to parts, tools, manuals and diagnostics needed to fix modern devices.</p>",
    "<p>Supporters say this extends product lifespans, cuts e-waste and lowers costs for households and small businesses while keeping local repair economies alive.</p>",
    "<h3>Why it matters</h3>",
    "<ul><li>Less e-waste â†’ lower environmental impact.</li><li>Cheaper fixes and longer device lifespans.</li><li>More competition and innovation in repair services.</li></ul>",
    "<p>Several regions are exploring or adopting frameworks that compel manufacturers to provide documentation and reasonably priced parts. Enforcement details vary, but the direction of travel is clear: repair should be a right, not a privilege.</p>"
  ]
}
</template>
  <script>
(function(){
  // Simple, page-local font scaling for the article body
  let scale = 1;

  function $(sel){ return document.querySelector(sel); }
  function getTpl(id){
    const t = document.getElementById('tpl-' + id);
    if(!t) return null;
    try { return JSON.parse(t.innerHTML.trim()); } catch(e){ return null; }
  }

  // Minimal TTS using Web Speech API
  const TTS = {
    speaking: false,
    utterance: null,
    toggle(text){
      if(!('speechSynthesis' in window)){ alert('Text-to-speech not supported.'); return; }
      if(this.speaking){ window.speechSynthesis.cancel(); this.speaking=false; $('#btnRead').setAttribute('aria-pressed','false'); return; }
      this.utterance = new SpeechSynthesisUtterance(text);
      this.utterance.rate = 1.0;
      window.speechSynthesis.speak(this.utterance);
      this.speaking = true;
      $('#btnRead').setAttribute('aria-pressed','true');
      this.utterance.onend = () => { this.speaking=false; $('#btnRead').setAttribute('aria-pressed','false'); };
    }
  };

  function openPreview(id){
    const data = getTpl(id);
    if(!data) return;

    $('#articleTitle').textContent = data.title || '';
    $('.article-meta').textContent = data.meta || '';
    const hero = $('.article-hero');
    hero.alt = data.imgAlt || '';
    hero.src = data.imgSrc || '';
    $('.article-body').innerHTML = (data.body || []).join('');

    // Reset scaling
    scale = 1;
    $('.article-body').style.fontSize = '1rem';

    const modal = $('#articleModal');
    modal.hidden = false;
    // Focus the close button for keyboard users
    modal.querySelector('.ds-modal__close').focus();

    // Read button binds current article text
    $('#btnRead').onclick = () => TTS.toggle($('#articleContent').innerText);
    $('#btnAplus').onclick = () => { scale = Math.min(1.4, scale + 0.05); $('.article-body').style.fontSize = (scale)+'rem'; };
    $('#btnAminus').onclick = () => { scale = Math.max(0.9, scale - 0.05); $('.article-body').style.fontSize = (scale)+'rem'; };
  }

  function closePreview(){
    const modal = $('#articleModal');
    modal.hidden = true;
    if(TTS.speaking){ window.speechSynthesis.cancel(); TTS.speaking=false; }
    // Clear hash without jumping
    if (location.hash) history.pushState('', document.title, location.pathname + location.search);
  }

  // Intercept hero click
  document.addEventListener('click', (e) => {
    const a = e.target.closest('a.card-link');
    if(!a) return;
    const href = a.getAttribute('href') || '';
    if(href === '#right-to-repair'){
      e.preventDefault();
      openPreview('right-to-repair');
      history.pushState(null, '', '#right-to-repair');
    }
  });

  // Open directly if the page loads with the hash
  if (location.hash === '#right-to-repair'){
    window.requestAnimationFrame(() => openPreview('right-to-repair'));
  }

  // Close events
  document.getElementById('articleModal').addEventListener('click', (e) => {
    if (e.target.matches('[data-close-modal]') || e.target.classList.contains('ds-modal__scrim')) {
      closePreview();
    }
  });
  window.addEventListener('keydown', (e) => { if(e.key === 'Escape' && !document.getElementById('articleModal').hidden) closePreview(); });
  window.addEventListener('hashchange', () => {
    if(location.hash !== '#right-to-repair' && !document.getElementById('articleModal').hidden) closePreview();
  });
})();
</script>

  <!-- MUST READ -->
  <section class="wrap section">
    <h2 class="section-heading">Must-Read</h2>

    <div class="cards-grid">
      <!-- Card 1 (large) -->
      <article class="story-card story-card--lg">
        <a class="card-link" href="./articles.html#inequality" aria-label="Rising Tides of Inequality"></a>
        <img loading="lazy" alt="City and informal settlements"
             src="https://unsplash.com/photos/person-repairing-smartphones-under-a-lighted-table-PZLgTUAhxMM">
        <div class="card-overlay">
          <span class="badge">ARTICLES</span>
          <h3 class="card-title">Rising Tides of Inequality</h3>
          <p class="card-excerpt">A visual deep dive into the global wealth gap post-COVID.</p>
          <div class="byline">By R. Correia Â· 6 min read</div>
        </div>
      </article>

      <!-- Card 2 -->
      <article class="story-card">
        <a class="card-link" href="./articles.html#heritage-retail" aria-label="How heritage retail survives slowdowns"></a>
        <img loading="lazy" alt="Historic facade at dusk"
             src="https://images.unsplash.com/photo-1488740304459-45c4277fdbb1?auto=format&fit=crop&w=1200&q=80">
        <div class="card-overlay">
          <span class="badge">RETAIL</span>
          <h3 class="card-title">How heritage retail survives slowdowns</h3>
          <p class="card-excerpt">What strategy shifts keep legacy stores resilient.</p>
          <div class="byline">By R. Correia Â· 5 min read</div>
        </div>
      </article>

      <!-- Card 3 -->
      <article class="story-card">
        <a class="card-link" href="./articles.html#quiet-luxury" aria-label="The Allure of Quiet Luxury"></a>
        <img loading="lazy" alt="Collage of travel and phones"
             src="https://images.unsplash.com/photo-1520975922323-364e138278bd?auto=format&fit=crop&w=1200&q=80">
        <div class="card-overlay">
          <span class="badge">STYLE & SOC</span>
          <h3 class="card-title">The Allure of Quiet Luxury</h3>
          <p class="card-excerpt">Why minimalism is the new status code.</p>
          <div class="byline">By R. Correia Â· 4 min read</div>
        </div>
      </article>

      <!-- Card 4 -->
      <article class="story-card">
        <a class="card-link" href="./articles.html#personalised-travel" aria-label="Personalised travel is the new status symbol"></a>
        <img loading="lazy" alt="People with phones while traveling"
             src="https://images.unsplash.com/photo-1530435460869-d13625c69bbf?auto=format&fit=crop&w=1200&q=80">
        <div class="card-overlay">
          <span class="badge">TECHNOLOGY</span>
          <h3 class="card-title">Personalised travel is the new status symbol</h3>
          <p class="card-excerpt">Algorithms are curating tasteâ€”and class.</p>
          <div class="byline">By R. Correia Â· 5 min read</div>
        </div>
      </article>

      <!-- ðŸ”§ Extra cards you can edit quickly (copy/paste as needed) -->
      <article class="story-card">
        <a class="card-link" href="./articles.html#climate-geopolitics" aria-label="The Geopolitics of Climate Action"></a>
        <img loading="lazy" alt="Wind farm silhouettes"
             src="https://images.unsplash.com/photo-1509395176047-4a66953fd231?auto=format&fit=crop&w=1200&q=80">
        <div class="card-overlay">
          <span class="badge">GEOPOLITICS</span>
          <h3 class="card-title">The Geopolitics of Climate Action</h3>
          <p class="card-excerpt">Why transition minerals are the new oil.</p>
          <div class="byline">By R. Correia Â· 7 min read</div>
        </div>
      </article>

      <article class="story-card">
        <a class="card-link" href="./articles.html#digital-divide" aria-label="Beyond Access: The Digital Divide"></a>
        <img loading="lazy" alt="Person using laptop at night"
             src="https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=1200&q=80">
        <div class="card-overlay">
          <span class="badge">INEQUALITY</span>
          <h3 class="card-title">Beyond Access: The Digital Divide</h3>
          <p class="card-excerpt">Connectivity doesnâ€™t equal opportunity.</p>
          <div class="byline">By R. Correia Â· 5 min read</div>
        </div>
      </article>

    </div>
  </section>
</main>

<footer class="ds-footer" role="contentinfo">
  <div class="wrap">
    <p>Â© <span id="year"></span> Diluted Stories Â· <a href="./contact.html">Contact</a></p>
  </div>
</footer>

<script src="./config.js"></script>
<script src="./scripts.js"></script>
<script>
  // Page-specific: set year and prep TTS main content
  document.getElementById('year').textContent = new Date().getFullYear();
  window.A11Y.initTTSTarget('#main-content');
</script>
</body>
</html>
